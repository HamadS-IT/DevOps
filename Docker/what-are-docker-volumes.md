# What Are `Docker Volumes`?

**Docker volumes** are the preferred mechanism for **persisting and sharing data** generated by Docker containers.  
They allow data to exist **outside the container’s lifecycle**, so data is not lost when containers stop or are removed.

---

## Why Docker Volumes Are Needed

Containers are **ephemeral** by nature:
- When a container is deleted, its filesystem is deleted
- Important data (databases, uploads, logs) would be lost

Volumes solve this problem by storing data independently.

---

## What Is a Docker Volume?

A Docker volume is:
- Managed by Docker
- Stored on the host machine
- Mountable into one or more containers
- Persistent across container restarts and removals

---

## Types of Data Storage in Docker

### 1. Volumes (Recommended)
- Fully managed by Docker
- Best for production

### 2. Bind Mounts
- Map a host directory to a container directory
- Good for development

### 3. tmpfs Mounts
- Stored in memory
- Data disappears when container stops

---

## Creating and Using Docker Volumes

### Create a Volume
```bash
docker volume create my_volume
````

### List Volumes

```bash
docker volume ls
```

### Inspect a Volume

```bash
docker volume inspect my_volume
```

---

## Use a Volume with a Container

```bash
docker run -v my_volume:/data nginx
```

Or using the modern syntax:

```bash
docker run --mount source=my_volume,target=/data nginx
```

---

## Volumes with Docker Compose

```yaml
services:
  db:
    image: postgres
    volumes:
      - db-data:/var/lib/postgresql/data

volumes:
  db-data:
```

---

## Sharing Volumes Between Containers

```bash
docker run -v shared-data:/app/data app1
docker run -v shared-data:/app/data app2
```

Both containers access the same data.

---

## Volume vs Container Layer

| Feature           | Volume | Container Layer |
| ----------------- | ------ | --------------- |
| Persistent        | ✅ Yes  | ❌ No            |
| Shared            | ✅ Yes  | ❌ No            |
| Performance       | ✅ High | ❌ Lower         |
| Managed by Docker | ✅ Yes  | ❌ No            |

---

## When to Use Docker Volumes

* Databases (MySQL, PostgreSQL, MongoDB)
* File uploads
* Application logs
* Shared app data
* Caching

---

## Backup and Restore Volumes

### Backup

```bash
docker run --rm \
  -v my_volume:/data \
  -v $(pwd):/backup \
  alpine tar czf /backup/backup.tar.gz /data
```

### Restore

```bash
docker run --rm \
  -v my_volume:/data \
  -v $(pwd):/backup \
  alpine tar xzf /backup/backup.tar.gz -C /
```

---

## Cleaning Up Volumes

### Remove Unused Volumes

```bash
docker volume prune
```

⚠️ This permanently deletes unused volumes.

---

## Best Practices

* Use volumes for persistent data
* Avoid storing data inside containers
* Name volumes clearly
* Back up important volumes regularly
* Don’t store secrets in volumes

---

## Summary

* Docker volumes persist data outside containers
* Survive container restarts and deletions
* Essential for databases and stateful apps
* Preferred storage solution in Docker

---

## Learn More

* [https://docs.docker.com/storage/volumes/](https://docs.docker.com/storage/volumes/)
